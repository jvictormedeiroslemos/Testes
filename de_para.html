<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DE-PARA | Trinus - Mapeamento EAP</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0%25' stop-color='%2300D4FF'/%3E%3Cstop offset='100%25' stop-color='%230066FF'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath d='M4 16L16 4l12 12-12 12z' fill='url(%23g)'/%3E%3C/svg%3E">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
<style>
:root{
  --trinus-blue:#0066FF;
  --trinus-blue-hover:#0052CC;
  --trinus-cyan:#00D4FF;
  --trinus-dark:#0B1222;
  --trinus-panel:#111B2E;
  --trinus-card:#152035;
  --trinus-border:#1E3050;
  --trinus-border-light:#2A4060;
  --trinus-text:#F0F4F8;
  --trinus-text-secondary:#94A3B8;
  --trinus-text-muted:#64748B;
  --trinus-success:#4ade80;
  --trinus-success-bg:#0D2E1A;
  --trinus-warn:#fb923c;
  --trinus-warn-bg:#2E1D0D;
  --trinus-info:#60a5fa;
  --trinus-info-bg:#0D1A2E;
  --trinus-gradient:linear-gradient(135deg,#00D4FF 0%,#0066FF 100%);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter','Segoe UI',system-ui,-apple-system,sans-serif;background:var(--trinus-dark);color:var(--trinus-text);min-height:100vh;-webkit-font-smoothing:antialiased}
.header{background:var(--trinus-panel);padding:0 32px;display:flex;align-items:center;justify-content:space-between;height:68px;border-bottom:1px solid var(--trinus-border)}
.header-left{display:flex;align-items:center;gap:20px}
.header-logo{display:flex;align-items:center;gap:10px;text-decoration:none}
.header-logo svg{width:36px;height:36px}
.header-logo span{font-size:22px;font-weight:700;color:var(--trinus-text);letter-spacing:-0.5px}
.header-divider{width:1px;height:32px;background:var(--trinus-border-light)}
.header-title{display:flex;flex-direction:column}
.header-title h1{font-size:15px;font-weight:600;color:var(--trinus-text);letter-spacing:-0.2px}
.header-title p{color:var(--trinus-text-muted);font-size:12px;margin-top:1px}
.header-badge{background:var(--trinus-gradient);color:#fff;font-size:11px;font-weight:600;padding:4px 12px;border-radius:20px;letter-spacing:0.3px}
.tabs{display:flex;background:var(--trinus-panel);border-bottom:1px solid var(--trinus-border);padding:0 32px;gap:4px}
.tab{padding:12px 20px;cursor:pointer;color:var(--trinus-text-muted);font-size:13px;font-weight:500;border-bottom:2px solid transparent;transition:all .2s;border-radius:6px 6px 0 0;position:relative}
.tab:hover{color:var(--trinus-text);background:rgba(0,102,255,0.05)}
.tab.active{color:var(--trinus-blue);border-bottom-color:var(--trinus-blue);background:rgba(0,102,255,0.08)}
.tab.active::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:2px;background:var(--trinus-gradient);border-radius:2px}
.content{padding:32px;max-width:1400px;margin:0 auto}
.section{display:none}
.section.active{display:block}
h2{color:var(--trinus-text);margin-bottom:16px;font-size:20px;font-weight:600;letter-spacing:-0.3px}
h2::before{content:'';display:inline-block;width:4px;height:20px;background:var(--trinus-gradient);border-radius:2px;margin-right:10px;vertical-align:middle}
h3{color:var(--trinus-text-secondary);margin:20px 0 10px;font-size:14px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}
label{display:block;color:var(--trinus-text-secondary);margin:8px 0 4px;font-size:13px;font-weight:500}
input,select,textarea{width:100%;padding:10px 14px;background:var(--trinus-dark);border:1px solid var(--trinus-border);color:var(--trinus-text);border-radius:8px;font-size:14px;font-family:inherit;transition:border-color .2s,box-shadow .2s}
input:focus,select:focus,textarea:focus{outline:none;border-color:var(--trinus-blue);box-shadow:0 0 0 3px rgba(0,102,255,0.15)}
textarea{resize:vertical}
button{padding:10px 24px;background:var(--trinus-blue);color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;font-family:inherit;transition:all .2s;letter-spacing:-0.1px}
button:hover{background:var(--trinus-blue-hover);transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,102,255,0.3)}
button:active{transform:translateY(0)}
button.secondary{background:var(--trinus-card);border:1px solid var(--trinus-border);color:var(--trinus-text-secondary)}
button.secondary:hover{background:var(--trinus-border);color:var(--trinus-text);transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,0.2)}
button:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}
.btn-row{margin:15px 0;display:flex;gap:10px;flex-wrap:wrap}
table{width:100%;border-collapse:collapse;margin:15px 0;font-size:13px}
th{background:var(--trinus-card);color:var(--trinus-blue);padding:12px 14px;text-align:left;border-bottom:2px solid var(--trinus-border);position:sticky;top:0;font-weight:600;font-size:12px;text-transform:uppercase;letter-spacing:0.5px}
td{padding:10px 14px;border-bottom:1px solid var(--trinus-border);color:var(--trinus-text-secondary)}
tr:hover{background:rgba(0,102,255,0.04)}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.card{background:var(--trinus-card);border:1px solid var(--trinus-border);border-radius:12px;padding:24px;transition:border-color .2s}
.card:hover{border-color:var(--trinus-border-light)}
.score-bar{height:6px;background:var(--trinus-border);border-radius:3px;overflow:hidden;width:100px;display:inline-block;vertical-align:middle;margin-left:8px}
.score-fill{height:100%;border-radius:3px}
.suggestion{background:var(--trinus-card);border:1px solid var(--trinus-border);border-radius:10px;padding:14px;margin:8px 0;cursor:pointer;transition:all .2s}
.suggestion:hover{border-color:var(--trinus-blue);background:rgba(0,102,255,0.06);transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,0,0,0.2)}
.suggestion.selected{border-color:var(--trinus-success);background:var(--trinus-success-bg)}
.alert{padding:14px 18px;border-radius:10px;margin:10px 0;font-size:14px;font-weight:500}
.alert-success{background:var(--trinus-success-bg);color:var(--trinus-success);border:1px solid #1a5c30}
.alert-info{background:var(--trinus-info-bg);color:var(--trinus-info);border:1px solid #1e3a6f}
.alert-warn{background:var(--trinus-warn-bg);color:var(--trinus-warn);border:1px solid #6a3210}
.metrics{display:flex;gap:15px;margin:15px 0;flex-wrap:wrap}
.metric{background:var(--trinus-card);border:1px solid var(--trinus-border);border-radius:12px;padding:18px 22px;text-align:center;flex:1;min-width:120px;transition:border-color .2s}
.metric:hover{border-color:var(--trinus-blue)}
.metric .num{font-size:30px;font-weight:700;background:var(--trinus-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.metric .lbl{font-size:12px;color:var(--trinus-text-muted);margin-top:4px;font-weight:500}
.filter-row{display:flex;gap:12px;align-items:end;margin-bottom:15px;flex-wrap:wrap}
.filter-row>div{flex:1;min-width:200px}
.table-wrap{max-height:500px;overflow-y:auto;border:1px solid var(--trinus-border);border-radius:10px}
.table-wrap::-webkit-scrollbar{width:6px}
.table-wrap::-webkit-scrollbar-track{background:var(--trinus-dark)}
.table-wrap::-webkit-scrollbar-thumb{background:var(--trinus-border-light);border-radius:3px}
.upload-area{border:2px dashed var(--trinus-border);border-radius:12px;padding:48px;text-align:center;cursor:pointer;transition:all .2s;background:rgba(0,102,255,0.02)}
.upload-area:hover{border-color:var(--trinus-blue);background:rgba(0,102,255,0.06)}
.upload-area input{display:none}
.hidden{display:none}
.progress{width:100%;height:6px;background:var(--trinus-border);border-radius:3px;overflow:hidden;margin:10px 0}
.progress-fill{height:100%;background:var(--trinus-gradient);border-radius:3px;transition:width .3s}
.badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;letter-spacing:0.3px}
.badge-1{background:rgba(0,102,255,0.15);color:var(--trinus-blue)}
.badge-2{background:rgba(0,212,255,0.15);color:var(--trinus-cyan)}
::selection{background:rgba(0,102,255,0.3);color:#fff}
@media(max-width:768px){.grid{grid-template-columns:1fr}.filter-row{flex-direction:column}.header{padding:0 16px;height:auto;flex-wrap:wrap;gap:12px;padding:12px 16px}.tabs{padding:0 16px;overflow-x:auto}}
</style>
</head>
<body>
<div class="header">
<div class="header-left">
<a class="header-logo" href="#">
<svg viewBox="0 0 120 40" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="logoGrad1" x1="0" y1="0" x2="32" y2="32" gradientUnits="userSpaceOnUse">
      <stop offset="0%" stop-color="#00D4FF"/>
      <stop offset="100%" stop-color="#0066FF"/>
    </linearGradient>
    <linearGradient id="logoGrad2" x1="8" y1="8" x2="28" y2="28" gradientUnits="userSpaceOnUse">
      <stop offset="0%" stop-color="#0066FF"/>
      <stop offset="100%" stop-color="#0044CC"/>
    </linearGradient>
  </defs>
  <!-- Trinus arrow/triangle logo mark -->
  <path d="M2 20L18 4L22 8L10 20L22 32L18 36Z" fill="url(#logoGrad1)"/>
  <path d="M12 20L22 10L26 14L18 20L26 26L22 30Z" fill="url(#logoGrad2)" opacity="0.85"/>
  <!-- trinus text -->
  <text x="34" y="27" fill="#F0F4F8" font-family="Inter,system-ui,sans-serif" font-size="18" font-weight="700" letter-spacing="-0.5">trinus</text>
</svg>
</a>
<div class="header-divider"></div>
<div class="header-title">
<h1>DE-PARA | Mapeamento EAP</h1>
<p>Classificacao inteligente via Claude AI</p>
</div>
</div>
<div class="header-badge">v2.0</div>
</div>
<div class="tabs">
<div class="tab active" onclick="showTab(0)">Mapeamento com IA</div>
<div class="tab" onclick="showTab(1)">Mapeamento Manual</div>
<div class="tab" onclick="showTab(2)">Estrutura EAP</div>
<div class="tab" onclick="showTab(3)">Exportar</div>
</div>
<div class="content">

<!-- TAB 0: IA -->
<div class="section active" id="tab0">
<h2>Mapeamento Inteligente (Claude API)</h2>

<div id="apiKeyArea" style="background:var(--trinus-card);border:1px solid var(--trinus-border);border-radius:12px;padding:20px;margin-bottom:20px">
<label style="display:flex;align-items:center;gap:6px;margin-bottom:8px"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg> Anthropic API Key</label>
<input type="password" id="apiKey" placeholder="sk-ant-api03-..." style="background:var(--trinus-dark)">
<p style="font-size:12px;color:var(--trinus-text-muted);margin-top:6px">Obtenha em <span style="color:var(--trinus-blue)">console.anthropic.com</span>. A chave nao e armazenada.</p>
</div>

<h3>Fonte dos lancamentos</h3>
<div style="display:flex;gap:10px;margin:10px 0">
<button onclick="setAISource('text')" id="btnSrcText">Digitar texto</button>
<button onclick="setAISource('file')" id="btnSrcFile" class="secondary">Upload planilha</button>
</div>
<div id="aiTextArea">
<label>Descricoes dos lancamentos (uma por linha):</label>
<textarea id="aiText" rows="8" placeholder="Ex:&#10;Pagamento energia eletrica obra&#10;Comissao corretor Joao&#10;Nota fiscal cimento 50 sacos"></textarea>
</div>
<div id="aiFileArea" class="hidden">
<div class="upload-area" onclick="document.getElementById('aiFileInput').click()">
<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--trinus-blue)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:12px"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
<p style="font-size:15px;color:var(--trinus-text);font-weight:500">Clique para selecionar arquivo</p>
<p style="font-size:12px;color:var(--trinus-text-muted);margin-top:6px">.xlsx, .xls ou .csv</p>
<input type="file" id="aiFileInput" accept=".xlsx,.xls,.csv" onchange="handleAIFile(this)">
</div>
<div id="aiFilePreview" class="hidden" style="margin-top:15px;background:var(--trinus-card);border:1px solid var(--trinus-border);border-radius:12px;padding:20px">
<label>Coluna principal (para identificacao visual):</label>
<select id="aiColPrimary" onchange="updateAIDescs()"></select>
<p style="font-size:11px;color:var(--trinus-text-muted);margin-top:6px">Todas as colunas serao enviadas para a IA automaticamente.</p>
<div id="aiFileInfo" style="margin-top:10px;color:var(--trinus-text-secondary);font-size:13px"></div>
</div>
</div>

<div class="grid" style="margin-top:15px">
<div>
<label>Filtrar sugestoes por Obra:</label>
<select id="aiObraFilter"><option value="TODAS">TODAS</option></select>
</div>
<div style="display:flex;align-items:end">
<button onclick="runAnalysis()" id="btnAnalyze" style="width:100%">Analisar com IA</button>
</div>
</div>

<div id="aiProgress" class="hidden" style="margin-top:15px">
<div style="color:var(--trinus-text-secondary);font-size:14px;font-weight:500" id="aiProgressText">Analisando...</div>
<div class="progress"><div class="progress-fill" id="aiProgressBar" style="width:0%"></div></div>
</div>

<div id="aiLog" class="hidden" style="margin-top:10px;max-height:200px;overflow-y:auto;background:var(--trinus-dark);border:1px solid var(--trinus-border);border-radius:10px;padding:12px;font-size:12px;font-family:'SF Mono',Monaco,Consolas,monospace;color:var(--trinus-text-muted)"></div>

<div id="aiResults" class="hidden" style="margin-top:20px">
<div class="metrics" id="aiMetrics"></div>
<h3>Sugestoes de Mapeamento</h3>
<div id="aiResultsList"></div>
<div class="btn-row">
<button onclick="confirmAIMappings()">Confirmar todos os mapeamentos</button>
<button class="secondary" onclick="exportAIResults()">Exportar para Excel</button>
</div>
</div>
</div>

<!-- TAB 1: MANUAL -->
<div class="section" id="tab1">
<h2>Mapeamento Manual DE-PARA</h2>
<div class="grid">
<div class="card">
<h3>DE (Origem)</h3>
<label>Descricao do lancamento:</label>
<input type="text" id="manDesc">
<label>Valor (R$):</label>
<input type="number" id="manValor" step="0.01" value="0">
<label>Tipo:</label>
<select id="manTipo"><option>Despesa</option><option>Receita</option></select>
<label>Data:</label>
<input type="date" id="manData">
<label>Fornecedor:</label>
<input type="text" id="manForn">
</div>
<div class="card">
<h3>PARA (EAP Destino)</h3>
<label>Obra destino:</label>
<select id="manObra" onchange="updateManualOptions()"><option value="TODAS">TODAS</option></select>
<label>Item EAP destino:</label>
<select id="manItem"></select>
<div id="manPreview" style="margin-top:15px;padding:12px;background:var(--trinus-dark);border:1px solid var(--trinus-border);border-radius:8px;font-size:13px;color:var(--trinus-text-secondary)"></div>
</div>
</div>
<div class="btn-row">
<button onclick="saveManualMapping()">Salvar Mapeamento</button>
</div>
<div id="manResults" class="hidden">
<h3>Mapeamentos realizados</h3>
<div class="table-wrap"><table id="manTable"><thead><tr><th>Descricao</th><th>Valor</th><th>Tipo</th><th>Data</th><th>Fornecedor</th><th>EAP Obra</th><th>EAP Item</th><th>EAP Descricao</th></tr></thead><tbody></tbody></table></div>
</div>
</div>

<!-- TAB 2: EAP -->
<div class="section" id="tab2">
<h2>Estrutura EAP</h2>
<div class="filter-row">
<div><label>Filtrar por Obra:</label><select id="eapObraFilter" onchange="renderEAPTable()"><option value="TODAS">TODAS</option></select></div>
<div><label>Buscar:</label><input type="text" id="eapSearch" placeholder="Digite para filtrar..." oninput="renderEAPTable()"></div>
</div>
<div id="eapMetrics" class="metrics"></div>
<div class="table-wrap"><table id="eapTable"><thead><tr><th>Obra</th><th>Produto</th><th>Item</th><th>Descricao</th></tr></thead><tbody></tbody></table></div>
</div>

<!-- TAB 3: EXPORT -->
<div class="section" id="tab3">
<h2>Exportar Dados</h2>
<div class="grid">
<div class="card"><h3>EAP Completa</h3><p style="color:var(--trinus-text-muted);font-size:13px;margin-bottom:15px">Baixar toda a estrutura EAP</p><button onclick="exportEAP()">Baixar EAP (Excel)</button></div>
<div class="card"><h3>Mapeamentos Manuais</h3><p style="color:var(--trinus-text-muted);font-size:13px;margin-bottom:15px">Baixar mapeamentos manuais</p><button onclick="exportManual()">Baixar Manuais (Excel)</button></div>
<div class="card"><h3>Mapeamentos IA</h3><p style="color:var(--trinus-text-muted);font-size:13px;margin-bottom:15px">Baixar mapeamentos da IA</p><button onclick="exportAIResults()">Baixar IA (Excel)</button></div>
<div class="card"><h3>Todos</h3><p style="color:var(--trinus-text-muted);font-size:13px;margin-bottom:15px">Baixar tudo em um arquivo</p><button onclick="exportAll()">Baixar Tudo (Excel)</button></div>
</div>
</div>
</div>
</div>

<script>
const EAP_DATA = [{"Obra": "ADM", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "ADM | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "ADM", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "ADM | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.01", "Descricao": "DESENVOLVIMENTO E GERENCIAMENTO", "Label": "ADM | 10070 DESPESA | 08.01 | DESENVOLVIMENTO E GERENCIAMENTO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.01.01", "Descricao": "DESENVOLVIMENTO", "Label": "ADM | 10070 DESPESA | 08.01.01 | DESENVOLVIMENTO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.01.02", "Descricao": "GERENCIAMENTO", "Label": "ADM | 10070 DESPESA | 08.01.02 | GERENCIAMENTO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02", "Descricao": "DESPESAS ADMINISTRATIVAS", "Label": "ADM | 10070 DESPESA | 08.02 | DESPESAS ADMINISTRATIVAS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.01", "Descricao": "DESPESAS COM UNIDADES EM ESTOQUE", "Label": "ADM | 10070 DESPESA | 08.02.01 | DESPESAS COM UNIDADES EM ESTOQUE"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.02", "Descricao": "DESPESAS FINANCEIRAS", "Label": "ADM | 10070 DESPESA | 08.02.02 | DESPESAS FINANCEIRAS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.03", "Descricao": "DESPESAS JURIDICAS", "Label": "ADM | 10070 DESPESA | 08.02.03 | DESPESAS JURIDICAS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.04", "Descricao": "DESPESAS CONTABEIS", "Label": "ADM | 10070 DESPESA | 08.02.04 | DESPESAS CONTABEIS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.05", "Descricao": "DESPESAS COM AUDITORIA", "Label": "ADM | 10070 DESPESA | 08.02.05 | DESPESAS COM AUDITORIA"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.06", "Descricao": "SISTEMAS", "Label": "ADM | 10070 DESPESA | 08.02.06 | SISTEMAS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.07", "Descricao": "SERVICOS DE APOIO ADMINISTRATIVO", "Label": "ADM | 10070 DESPESA | 08.02.07 | SERVICOS DE APOIO ADMINISTRATIVO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.08", "Descricao": "TAXAS E CERTIDOES E ANUIDADES", "Label": "ADM | 10070 DESPESA | 08.02.08 | TAXAS E CERTIDOES E ANUIDADES"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.02.09", "Descricao": "VIAGENS E ESTADIAS ATRELADO A ADMINISTRACAO", "Label": "ADM | 10070 DESPESA | 08.02.09 | VIAGENS E ESTADIAS ATRELADO A ADMINISTRACAO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.03", "Descricao": "OUTRAS DESPESAS ADMINISTRACAO DO EMPREENDIMENTO (SPE)", "Label": "ADM | 10070 DESPESA | 08.03 | OUTRAS DESPESAS ADMINISTRACAO DO EMPREENDIMENTO (SPE)"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.03.01", "Descricao": "SEDE DO EMPREENDIMENTO SPE (CONSTRUCAO)", "Label": "ADM | 10070 DESPESA | 08.03.01 | SEDE DO EMPREENDIMENTO SPE (CONSTRUCAO)"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.03.02", "Descricao": "SEDE DO EMPREENDIMENTO SPE (MANUTENCAO)", "Label": "ADM | 10070 DESPESA | 08.03.02 | SEDE DO EMPREENDIMENTO SPE (MANUTENCAO)"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.04", "Descricao": "GESTAO DE CARTEIRA", "Label": "ADM | 10070 DESPESA | 08.04 | GESTAO DE CARTEIRA"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.04.01", "Descricao": "INTERCAMBIADORA", "Label": "ADM | 10070 DESPESA | 08.04.01 | INTERCAMBIADORA"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.04.01", "Descricao": "REDE INTERCAMBIADORA", "Label": "ADM | 10070 DESPESA | 08.04.01 | REDE INTERCAMBIADORA"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.04.02", "Descricao": "TAXA DE ADMINISTRACAO", "Label": "ADM | 10070 DESPESA | 08.04.02 | TAXA DE ADMINISTRACAO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "08.04.03", "Descricao": "VIAGENS E ESTADIAS ATRELADOS A GESTAO DE CARTEIRA", "Label": "ADM | 10070 DESPESA | 08.04.03 | VIAGENS E ESTADIAS ATRELADOS A GESTAO DE CARTEIRA"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "15", "Descricao": "FOLHA DE PAGAMENTO", "Label": "ADM | 10070 DESPESA | 15 | FOLHA DE PAGAMENTO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "15.01", "Descricao": "ENCARGOS TRABALHISTAS", "Label": "ADM | 10070 DESPESA | 15.01 | ENCARGOS TRABALHISTAS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "15.01", "Descricao": "FOLHA DE PAGAMENTO", "Label": "ADM | 10070 DESPESA | 15.01 | FOLHA DE PAGAMENTO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "15.01", "Descricao": "FOLHA DE PAGAMENTO - ENCARGOS TRABALHISTAS PATRONAL", "Label": "ADM | 10070 DESPESA | 15.01 | FOLHA DE PAGAMENTO - ENCARGOS TRABALHISTAS PATRONAL"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "15.01", "Descricao": "SALARIOS", "Label": "ADM | 10070 DESPESA | 15.01 | SALARIOS"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "16", "Descricao": "MIGRAÇÃO", "Label": "ADM | 10070 DESPESA | 16 | MIGRAÇÃO"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "16.01", "Descricao": "OUTROS (MIGRACAO)", "Label": "ADM | 10070 DESPESA | 16.01 | OUTROS (MIGRACAO)"}, {"Obra": "ADM", "Produto": "10070 DESPESA", "Item": "8", "Descricao": "DESPESA ADMINISTRATIVA", "Label": "ADM | 10070 DESPESA | 8 | DESPESA ADMINISTRATIVA"}, {"Obra": "ALP", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "ALP | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "ALP", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "ALP | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "05.", "Descricao": "CUSTO DE PROJETOS E CONSULTORIAS", "Label": "ALP | 10060 CUSTO | 05. | CUSTO DE PROJETOS E CONSULTORIAS"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "05.01", "Descricao": "CUSTO DE PROJETOS", "Label": "ALP | 10060 CUSTO | 05.01 | CUSTO DE PROJETOS"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "05.02", "Descricao": "CUSTO DE CONSULTORIAS E LAUDOS", "Label": "ALP | 10060 CUSTO | 05.02 | CUSTO DE CONSULTORIAS E LAUDOS"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "05.03", "Descricao": "COPIAS HELIOGRAFICAS", "Label": "ALP | 10060 CUSTO | 05.03 | COPIAS HELIOGRAFICAS"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "06.", "Descricao": "CUSTO DE LEGALIZACAO E APROVACOES", "Label": "ALP | 10060 CUSTO | 06. | CUSTO DE LEGALIZACAO E APROVACOES"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "06.01", "Descricao": "DESPESAS CARTORIOS (APROVACAO)", "Label": "ALP | 10060 CUSTO | 06.01 | DESPESAS CARTORIOS (APROVACAO)"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "06.02", "Descricao": "CONSULTORIAS JURIDICAS", "Label": "ALP | 10060 CUSTO | 06.02 | CONSULTORIAS JURIDICAS"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "06.03", "Descricao": "CUSTO DE LEGALIZACAO E APROVACOES", "Label": "ALP | 10060 CUSTO | 06.03 | CUSTO DE LEGALIZACAO E APROVACOES"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "07.01", "Descricao": "OUTROS (MIGRACAO)", "Label": "ALP | 10060 CUSTO | 07.01 | OUTROS (MIGRACAO)"}, {"Obra": "ALP", "Produto": "10060 CUSTO", "Item": "7", "Descricao": "MIGRAÇÃO", "Label": "ALP | 10060 CUSTO | 7 | MIGRAÇÃO"}, {"Obra": "APT", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "APT | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "APT", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "APT | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "APT", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.02", "Descricao": "APORTES HOLDING", "Label": "APT | 10080 MOVIMENTACAO FINANCEIRA | 13.02 | APORTES HOLDING"}, {"Obra": "APT", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.02.01", "Descricao": "APORTE HOLDING", "Label": "APT | 10080 MOVIMENTACAO FINANCEIRA | 13.02.01 | APORTE HOLDING"}, {"Obra": "APT", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.02.01", "Descricao": "APORTES HOLDING", "Label": "APT | 10080 MOVIMENTACAO FINANCEIRA | 13.02.01 | APORTES HOLDING"}, {"Obra": "CAQ", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "CAQ | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "CAQ", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "CAQ | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.", "Descricao": "CUSTO DO TERRENO", "Label": "CAQ | 10060 CUSTO | 07. | CUSTO DO TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.01", "Descricao": "AQUISICAO DE TERRENO", "Label": "CAQ | 10060 CUSTO | 07.01 | AQUISICAO DE TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.02", "Descricao": "ACERTO PERMUTA REMANESCENTE", "Label": "CAQ | 10060 CUSTO | 07.02 | ACERTO PERMUTA REMANESCENTE"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.03", "Descricao": "ALUGUEL DE IMOVEIS PARA PERMUTANTES", "Label": "CAQ | 10060 CUSTO | 07.03 | ALUGUEL DE IMOVEIS PARA PERMUTANTES"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.04", "Descricao": "FIANCA BANCARIA / SEGURO PERFORMANCE BOND / GARANTIA TERRENO", "Label": "CAQ | 10060 CUSTO | 07.04 | FIANCA BANCARIA / SEGURO PERFORMANCE BOND / GARANTIA TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.05", "Descricao": "ITBI / ISTI / REGISTRO", "Label": "CAQ | 10060 CUSTO | 07.05 | ITBI / ISTI / REGISTRO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.06", "Descricao": "IPTU / ITU / AGUA E ENERGIA DO TERRENO", "Label": "CAQ | 10060 CUSTO | 07.06 | IPTU / ITU / AGUA E ENERGIA DO TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.07", "Descricao": "INTERMEDIACAO DE NEGOCIO", "Label": "CAQ | 10060 CUSTO | 07.07 | INTERMEDIACAO DE NEGOCIO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.08", "Descricao": "LEGALIZACAO DE TERRENO", "Label": "CAQ | 10060 CUSTO | 07.08 | LEGALIZACAO DE TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.09", "Descricao": "LEVANTAMENTO PLANIALTIMETRICO / SONDAGEM", "Label": "CAQ | 10060 CUSTO | 07.09 | LEVANTAMENTO PLANIALTIMETRICO / SONDAGEM"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.10", "Descricao": "ESCRITURA / OUTRAS CERTIDOES", "Label": "CAQ | 10060 CUSTO | 07.10 | ESCRITURA / OUTRAS CERTIDOES"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.11", "Descricao": "CONSTRUCAO DE EDIFICACOES", "Label": "CAQ | 10060 CUSTO | 07.11 | CONSTRUCAO DE EDIFICACOES"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.12", "Descricao": "DEMOLICAO DE EDIFICACOES EXISTENTES / LIMPEZA", "Label": "CAQ | 10060 CUSTO | 07.12 | DEMOLICAO DE EDIFICACOES EXISTENTES / LIMPEZA"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.13", "Descricao": "CANCELAMENTO DE LIGACOES DE AGUA E ESGOTO", "Label": "CAQ | 10060 CUSTO | 07.13 | CANCELAMENTO DE LIGACOES DE AGUA E ESGOTO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.14", "Descricao": "CORTE E REMOCAO DE ARVORES", "Label": "CAQ | 10060 CUSTO | 07.14 | CORTE E REMOCAO DE ARVORES"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.15", "Descricao": "REMEMBRAMENTO DE TERRENO", "Label": "CAQ | 10060 CUSTO | 07.15 | REMEMBRAMENTO DE TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.16", "Descricao": "COMISSAO SOBRE TERRENO", "Label": "CAQ | 10060 CUSTO | 07.16 | COMISSAO SOBRE TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.17", "Descricao": "CONDOMINIO SOBRE TERRENO", "Label": "CAQ | 10060 CUSTO | 07.17 | CONDOMINIO SOBRE TERRENO"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.18", "Descricao": "OUTORGA ONEROSA / TRANSFERENCIA DE INDICE", "Label": "CAQ | 10060 CUSTO | 07.18 | OUTORGA ONEROSA / TRANSFERENCIA DE INDICE"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.19", "Descricao": "ASSESSORIA NA CAPTACAO DE TERRENOS", "Label": "CAQ | 10060 CUSTO | 07.19 | ASSESSORIA NA CAPTACAO DE TERRENOS"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.20", "Descricao": "ANALISE JURIDICA DO TERRENO POR IMOVEL", "Label": "CAQ | 10060 CUSTO | 07.20 | ANALISE JURIDICA DO TERRENO POR IMOVEL"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.21", "Descricao": "COMPRA DE IMOVEIS", "Label": "CAQ | 10060 CUSTO | 07.21 | COMPRA DE IMOVEIS"}, {"Obra": "CAQ", "Produto": "10060 CUSTO", "Item": "07.22", "Descricao": "OUTROS CUSTOS DE TERRENO", "Label": "CAQ | 10060 CUSTO | 07.22 | OUTROS CUSTOS DE TERRENO"}, {"Obra": "CDR", "Produto": "10000 DEDUTORES DE RECEITA", "Item": "0", "Descricao": "DEDUTORES DE RECEITA", "Label": "CDR | 10000 DEDUTORES DE RECEITA | 0 | DEDUTORES DE RECEITA"}, {"Obra": "CDR", "Produto": "10000 DEDUTORES DE RECEITA", "Item": "00.01", "Descricao": "DISTRATO DE VENDA", "Label": "CDR | 10000 DEDUTORES DE RECEITA | 00.01 | DISTRATO DE VENDA"}, {"Obra": "CDR", "Produto": "10000 DEDUTORES DE RECEITA", "Item": "00.02", "Descricao": "IMPOSTOS SOBRE RECEITA", "Label": "CDR | 10000 DEDUTORES DE RECEITA | 00.02 | IMPOSTOS SOBRE RECEITA"}, {"Obra": "CDR", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "CDR | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "CDR", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "CDR | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "COM", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "COM | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "COM", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "COM | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "09.01", "Descricao": "COORDENACAO COMERCIAL", "Label": "COM | 10070 DESPESA | 09.01 | COORDENACAO COMERCIAL"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "09.02", "Descricao": "COMISSOES", "Label": "COM | 10070 DESPESA | 09.02 | COMISSOES"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "09.03", "Descricao": "PREMIACAO DE CORRETORES (VENDAS)", "Label": "COM | 10070 DESPESA | 09.03 | PREMIACAO DE CORRETORES (VENDAS)"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "09.04", "Descricao": "TAXA DE ASSOCIACAO PARCERIAS (VENDAS)", "Label": "COM | 10070 DESPESA | 09.04 | TAXA DE ASSOCIACAO PARCERIAS (VENDAS)"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "09.05", "Descricao": "VIAGENS E ESTADIAS ATRELADAS A COMERCIALIZACAO", "Label": "COM | 10070 DESPESA | 09.05 | VIAGENS E ESTADIAS ATRELADAS A COMERCIALIZACAO"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "16", "Descricao": "FOLHA DE PAGAMENTO COMERCIAL", "Label": "COM | 10070 DESPESA | 16 | FOLHA DE PAGAMENTO COMERCIAL"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "16.01", "Descricao": "ENCARGOS TRABALHISTAS", "Label": "COM | 10070 DESPESA | 16.01 | ENCARGOS TRABALHISTAS"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "16.01", "Descricao": "FOLHA DE PAGAMENTO - ENCARGOS TRABALHISTAS PATRONAL", "Label": "COM | 10070 DESPESA | 16.01 | FOLHA DE PAGAMENTO - ENCARGOS TRABALHISTAS PATRONAL"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "16.01", "Descricao": "FOLHA DE PAGAMENTO COMERCIAL", "Label": "COM | 10070 DESPESA | 16.01 | FOLHA DE PAGAMENTO COMERCIAL"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "16.01", "Descricao": "SALARIOS", "Label": "COM | 10070 DESPESA | 16.01 | SALARIOS"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "17", "Descricao": "MIGRAÇÃO", "Label": "COM | 10070 DESPESA | 17 | MIGRAÇÃO"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "17.01", "Descricao": "OUTROS (MIGRACAO)", "Label": "COM | 10070 DESPESA | 17.01 | OUTROS (MIGRACAO)"}, {"Obra": "COM", "Produto": "10070 DESPESA", "Item": "9", "Descricao": "DESPESA COMERCIAL", "Label": "COM | 10070 DESPESA | 9 | DESPESA COMERCIAL"}, {"Obra": "DIS", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "DIS | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "DIS", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "DIS | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13", "Descricao": "DISTRIBUICAO", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13 | DISTRIBUICAO"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.01", "Descricao": "DISTRIBUICAO TERRENEIRO", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.01 | DISTRIBUICAO TERRENEIRO"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.02", "Descricao": "DISTRIBUICAO DESENVOLVEDOR", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.02 | DISTRIBUICAO DESENVOLVEDOR"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.03", "Descricao": "DISTRIBUICAO FUNDO", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.03 | DISTRIBUICAO FUNDO"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.04", "Descricao": "ADIANTAMENTO DE DIVIDENDOS TERRENEIROS", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.04 | ADIANTAMENTO DE DIVIDENDOS TERRENEIROS"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.05", "Descricao": "ADIANTAMENTO DE DIVIDENDOS DESENVOLVIMENTO", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.05 | ADIANTAMENTO DE DIVIDENDOS DESENVOLVIMENTO"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.06", "Descricao": "ADIANTAMENTO DE DIVIDENDOS FUNDO (FII)", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.06 | ADIANTAMENTO DE DIVIDENDOS FUNDO (FII)"}, {"Obra": "DIS", "Produto": "10080 MOVIMENTACAO FINANCEIRA", "Item": "13.07", "Descricao": "REDUCAO DE CAPITAL / AFAC", "Label": "DIS | 10080 MOVIMENTACAO FINANCEIRA | 13.07 | REDUCAO DE CAPITAL / AFAC"}, {"Obra": "DPO", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "DPO | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "DPO", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "DPO | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "DPO", "Produto": "10070 DESPESA", "Item": "14.", "Descricao": "DESPESAS DE GARANTIA / POS OBRA", "Label": "DPO | 10070 DESPESA | 14. | DESPESAS DE GARANTIA / POS OBRA"}, {"Obra": "DPO", "Produto": "10070 DESPESA", "Item": "14..03", "Descricao": "DESPESAS MANUTENCAO POS OBRA", "Label": "DPO | 10070 DESPESA | 14..03 | DESPESAS MANUTENCAO POS OBRA"}, {"Obra": "DPO", "Produto": "10070 DESPESA", "Item": "14..03", "Descricao": "DESPESAS MANUTENÇÃO POS OBRA", "Label": "DPO | 10070 DESPESA | 14..03 | DESPESAS MANUTENÇÃO POS OBRA"}, {"Obra": "DPO", "Produto": "10070 DESPESA", "Item": "14.01", "Descricao": "DESPESAS PRE OPERACIONAIS", "Label": "DPO | 10070 DESPESA | 14.01 | DESPESAS PRE OPERACIONAIS"}, {"Obra": "DPO", "Produto": "10070 DESPESA", "Item": "14.02", "Descricao": "GARANTIA TECNICA POS OBRA", "Label": "DPO | 10070 DESPESA | 14.02 | GARANTIA TECNICA POS OBRA"}, {"Obra": "DPV", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "DPV | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "DPV", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "DPV | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "DPV", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "11.", "Descricao": "POS VENDA", "Label": "DPV | 10050 DEVOLUCAO/ESTORNO | 11. | POS VENDA"}, {"Obra": "DPV", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "11.01", "Descricao": "DESPESAS DE POS VENDA COM O CLIENTE", "Label": "DPV | 10050 DEVOLUCAO/ESTORNO | 11.01 | DESPESAS DE POS VENDA COM O CLIENTE"}, {"Obra": "DPV", "Produto": "10070 DESPESA", "Item": "11.", "Descricao": "POS VENDA", "Label": "DPV | 10070 DESPESA | 11. | POS VENDA"}, {"Obra": "DPV", "Produto": "10070 DESPESA", "Item": "11.01", "Descricao": "DESPESAS DE POS VENDA COM O CLIENTE", "Label": "DPV | 10070 DESPESA | 11.01 | DESPESAS DE POS VENDA COM O CLIENTE"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.", "Descricao": "EMPRESTIMO", "Label": "EMP | 10040 EMPRESTIMO | 12. | EMPRESTIMO"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.01", "Descricao": "CAPITAL DE GIRO", "Label": "EMP | 10040 EMPRESTIMO | 12.01 | CAPITAL DE GIRO"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.02", "Descricao": "FINANCIAMENTO A PRODUCAO", "Label": "EMP | 10040 EMPRESTIMO | 12.02 | FINANCIAMENTO A PRODUCAO"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.02", "Descricao": "FINANCIAMENTO APOIO A PRODUCAO - AMORTIZACOES DE EMPRESTIMOS", "Label": "EMP | 10040 EMPRESTIMO | 12.02 | FINANCIAMENTO APOIO A PRODUCAO - AMORTIZACOES DE EMPRESTIMOS"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.02", "Descricao": "FINANCIAMENTO APOIO A PRODUCAO - MULTAS E JUROS ATRASO", "Label": "EMP | 10040 EMPRESTIMO | 12.02 | FINANCIAMENTO APOIO A PRODUCAO - MULTAS E JUROS ATRASO"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.02", "Descricao": "FINANCIAMENTO APOIO A PRODUCAO - OUTRAS DESPESAS", "Label": "EMP | 10040 EMPRESTIMO | 12.02 | FINANCIAMENTO APOIO A PRODUCAO - OUTRAS DESPESAS"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.02", "Descricao": "FINANCIAMENTO APOIO A PRODUCAO - PAGAMENTO DE JUROS (CUSTO)", "Label": "EMP | 10040 EMPRESTIMO | 12.02 | FINANCIAMENTO APOIO A PRODUCAO - PAGAMENTO DE JUROS (CUSTO)"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.03", "Descricao": "SECURITIZACAO DA CARTEIRA (CRI)", "Label": "EMP | 10040 EMPRESTIMO | 12.03 | SECURITIZACAO DA CARTEIRA (CRI)"}, {"Obra": "EMP", "Produto": "10040 EMPRESTIMO", "Item": "12.04", "Descricao": "EMPRESTIMO A SOCIOS / TERCEIROS", "Label": "EMP | 10040 EMPRESTIMO | 12.04 | EMPRESTIMO A SOCIOS / TERCEIROS"}, {"Obra": "EMP", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "EMP | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "MKT", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "MKT | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "MKT", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "MKT | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10", "Descricao": "DESPESAS COM PUBLICIDADE E MARKETING", "Label": "MKT | 10070 DESPESA | 10 | DESPESAS COM PUBLICIDADE E MARKETING"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.01", "Descricao": "CONSULTORIAS E ASSESSORIAS", "Label": "MKT | 10070 DESPESA | 10.01 | CONSULTORIAS E ASSESSORIAS"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.02", "Descricao": "AGENCIA", "Label": "MKT | 10070 DESPESA | 10.02 | AGENCIA"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "ACOES COMERCIAIS (PROMOVIDAS/SOLICITADAS POR CORRETORES)", "Label": "MKT | 10070 DESPESA | 10.03 | ACOES COMERCIAIS (PROMOVIDAS/SOLICITADAS POR CORRETORES)"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "ACOES DE MARKETING PROMOCIONAL", "Label": "MKT | 10070 DESPESA | 10.03 | ACOES DE MARKETING PROMOCIONAL"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "CAMPANHA DE PREMIACAO PARA CORRETORES", "Label": "MKT | 10070 DESPESA | 10.03 | CAMPANHA DE PREMIACAO PARA CORRETORES"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "ENDOMARKETING", "Label": "MKT | 10070 DESPESA | 10.03 | ENDOMARKETING"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "EVENTO DE LANCAMENTO", "Label": "MKT | 10070 DESPESA | 10.03 | EVENTO DE LANCAMENTO"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "EVENTOS", "Label": "MKT | 10070 DESPESA | 10.03 | EVENTOS"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "MEETING", "Label": "MKT | 10070 DESPESA | 10.03 | MEETING"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.03", "Descricao": "PRODUCOES ON/OFF", "Label": "MKT | 10070 DESPESA | 10.03 | PRODUCOES ON/OFF"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.04", "Descricao": "PATROCINIO", "Label": "MKT | 10070 DESPESA | 10.04 | PATROCINIO"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.05", "Descricao": "IMPRESSOS E MATERIAIS PUBLICITARIOS (VENDAS)", "Label": "MKT | 10070 DESPESA | 10.05 | IMPRESSOS E MATERIAIS PUBLICITARIOS (VENDAS)"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.06", "Descricao": "MIDIA (RADIO, OUTDOOR)", "Label": "MKT | 10070 DESPESA | 10.06 | MIDIA (RADIO, OUTDOOR)"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.07", "Descricao": "DIGITAL (SITE, GOOGLE, APP, MIDIAS SOCIAIS)", "Label": "MKT | 10070 DESPESA | 10.07 | DIGITAL (SITE, GOOGLE, APP, MIDIAS SOCIAIS)"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.08", "Descricao": "BRINDES", "Label": "MKT | 10070 DESPESA | 10.08 | BRINDES"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.09", "Descricao": "MAQUETE FISICA", "Label": "MKT | 10070 DESPESA | 10.09 | MAQUETE FISICA"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.10", "Descricao": "MAQUETES ELETRONICAS E IMAGENS", "Label": "MKT | 10070 DESPESA | 10.10 | MAQUETES ELETRONICAS E IMAGENS"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.11", "Descricao": "VIAGENS E ESTADIAS ATRELADO A MARKETING", "Label": "MKT | 10070 DESPESA | 10.11 | VIAGENS E ESTADIAS ATRELADO A MARKETING"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "10.12", "Descricao": "CAPTACAO DE CLIENTES / LEADS", "Label": "MKT | 10070 DESPESA | 10.12 | CAPTACAO DE CLIENTES / LEADS"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "17", "Descricao": "FOLHA DE PAGAMENTO MARKETING", "Label": "MKT | 10070 DESPESA | 17 | FOLHA DE PAGAMENTO MARKETING"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "17.01", "Descricao": "ENCARGOS TRABALHISTAS", "Label": "MKT | 10070 DESPESA | 17.01 | ENCARGOS TRABALHISTAS"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "17.01", "Descricao": "FOLHA DE PAGAMENTO - ENCARGOS TRABALHISTAS PATRONAL", "Label": "MKT | 10070 DESPESA | 17.01 | FOLHA DE PAGAMENTO - ENCARGOS TRABALHISTAS PATRONAL"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "17.01", "Descricao": "FOLHA DE PAGAMENTO MARKETING", "Label": "MKT | 10070 DESPESA | 17.01 | FOLHA DE PAGAMENTO MARKETING"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "17.01", "Descricao": "SALARIOS", "Label": "MKT | 10070 DESPESA | 17.01 | SALARIOS"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "18", "Descricao": "MIGRAÇÃO", "Label": "MKT | 10070 DESPESA | 18 | MIGRAÇÃO"}, {"Obra": "MKT", "Produto": "10070 DESPESA", "Item": "18.01", "Descricao": "OUTROS (MIGRACAO)", "Label": "MKT | 10070 DESPESA | 18.01 | OUTROS (MIGRACAO)"}, {"Obra": "OBR", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "OBR | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "OBR", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "OBR | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.", "Descricao": "CUSTO OBRA", "Label": "OBR | 10060 CUSTO | 01. | CUSTO OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.01", "Descricao": "EQUIPE TECNICA ( GESTAO DE OBRA)", "Label": "OBR | 10060 CUSTO | 01.01 | EQUIPE TECNICA ( GESTAO DE OBRA)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.01.01", "Descricao": "EQUIPE TECNICA", "Label": "OBR | 10060 CUSTO | 01.01.01 | EQUIPE TECNICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.01.02", "Descricao": "VIAGENS", "Label": "OBR | 10060 CUSTO | 01.01.02 | VIAGENS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.01.02", "Descricao": "VIAGENS E ESTADIAS ATRELADO A OBRA", "Label": "OBR | 10060 CUSTO | 01.01.02 | VIAGENS E ESTADIAS ATRELADO A OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02", "Descricao": "CUSTAS OPERACIONAIS E OUTROS CUSTOS INDIRETOS", "Label": "OBR | 10060 CUSTO | 01.02 | CUSTAS OPERACIONAIS E OUTROS CUSTOS INDIRETOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.01", "Descricao": "MAO DE OBRA INDIRETA - OBRA", "Label": "OBR | 10060 CUSTO | 01.02.01 | MAO DE OBRA INDIRETA - OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.02", "Descricao": "MATERIAL DE CONSUMO CANTEIRO", "Label": "OBR | 10060 CUSTO | 01.02.02 | MATERIAL DE CONSUMO CANTEIRO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.03", "Descricao": "CONSUMOS (AGUA, ENERGIA E INTERNET / TELEFONE)", "Label": "OBR | 10060 CUSTO | 01.02.03 | CONSUMOS (AGUA, ENERGIA E INTERNET / TELEFONE)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.04", "Descricao": "MANUTENCAO DE MAQUINAS EQUIPAMENTOS", "Label": "OBR | 10060 CUSTO | 01.02.04 | MANUTENCAO DE MAQUINAS EQUIPAMENTOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.05", "Descricao": "AQUISICAO E LOCACAO DE MAQUINAS E EQUIPAMENTOS", "Label": "OBR | 10060 CUSTO | 01.02.05 | AQUISICAO E LOCACAO DE MAQUINAS E EQUIPAMENTOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.06", "Descricao": "SEGURO DE OBRA", "Label": "OBR | 10060 CUSTO | 01.02.06 | SEGURO DE OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.07", "Descricao": "LIGACAO PROVISORIA DE AGUA E ENERGIA", "Label": "OBR | 10060 CUSTO | 01.02.07 | LIGACAO PROVISORIA DE AGUA E ENERGIA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.08", "Descricao": "CANTEIRO DE OBRA / BARRACAO DE OBRA", "Label": "OBR | 10060 CUSTO | 01.02.08 | CANTEIRO DE OBRA / BARRACAO DE OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.02.09", "Descricao": "FERRAMENTAS GERAIS, EPI`S E EPC`S", "Label": "OBR | 10060 CUSTO | 01.02.09 | FERRAMENTAS GERAIS, EPI`S E EPC`S"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.03", "Descricao": "INSTALACAO DO CANTEIRO / SERVICOS PRELIMINARES", "Label": "OBR | 10060 CUSTO | 01.03 | INSTALACAO DO CANTEIRO / SERVICOS PRELIMINARES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.03.01", "Descricao": "DISTRIBUICAO PROVISORA DE AGUA/ESGOTO/ENERGIA", "Label": "OBR | 10060 CUSTO | 01.03.01 | DISTRIBUICAO PROVISORA DE AGUA/ESGOTO/ENERGIA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.03.02", "Descricao": "SERVICOS AUXILIARES", "Label": "OBR | 10060 CUSTO | 01.03.02 | SERVICOS AUXILIARES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.03.03", "Descricao": "PLACAS", "Label": "OBR | 10060 CUSTO | 01.03.03 | PLACAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.04", "Descricao": "INFRA-ESTRUTURA", "Label": "OBR | 10060 CUSTO | 01.04 | INFRA-ESTRUTURA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.04.01", "Descricao": "IMPLANTACAO DA OBRA", "Label": "OBR | 10060 CUSTO | 01.04.01 | IMPLANTACAO DA OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.04.02", "Descricao": "MOVIMENTACAO DE TERRA", "Label": "OBR | 10060 CUSTO | 01.04.02 | MOVIMENTACAO DE TERRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.04.03", "Descricao": "FUNDACAO", "Label": "OBR | 10060 CUSTO | 01.04.03 | FUNDACAO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.04.04", "Descricao": "CONTENCAO", "Label": "OBR | 10060 CUSTO | 01.04.04 | CONTENCAO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.05", "Descricao": "SUPRAESTRUTURA", "Label": "OBR | 10060 CUSTO | 01.05 | SUPRAESTRUTURA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.05.01", "Descricao": "ESTRUTURA", "Label": "OBR | 10060 CUSTO | 01.05.01 | ESTRUTURA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.06", "Descricao": "PAREDES / VEDACOES", "Label": "OBR | 10060 CUSTO | 01.06 | PAREDES / VEDACOES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.06.01", "Descricao": "PAREDES / VEDACOES", "Label": "OBR | 10060 CUSTO | 01.06.01 | PAREDES / VEDACOES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07", "Descricao": "ESQUADRIAS EM GERAL", "Label": "OBR | 10060 CUSTO | 01.07 | ESQUADRIAS EM GERAL"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07.01", "Descricao": "ESQUADRIAS EM ALUMINIO", "Label": "OBR | 10060 CUSTO | 01.07.01 | ESQUADRIAS EM ALUMINIO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07.02", "Descricao": "ESQUADRIAS EM MADEIRA", "Label": "OBR | 10060 CUSTO | 01.07.02 | ESQUADRIAS EM MADEIRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07.03", "Descricao": "ESQUADRIAS EM FERRO", "Label": "OBR | 10060 CUSTO | 01.07.03 | ESQUADRIAS EM FERRO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07.04", "Descricao": "ESQUADRIAS EM PVC", "Label": "OBR | 10060 CUSTO | 01.07.04 | ESQUADRIAS EM PVC"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07.05", "Descricao": "FACHADA MODULAR / UNITIZADA", "Label": "OBR | 10060 CUSTO | 01.07.05 | FACHADA MODULAR / UNITIZADA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.07.06", "Descricao": "PORTA CORTA-FOGO", "Label": "OBR | 10060 CUSTO | 01.07.06 | PORTA CORTA-FOGO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08", "Descricao": "INSTALACOES ELETRICAS / TELEFONICAS / ANTENAS / SPDA / DADOS", "Label": "OBR | 10060 CUSTO | 01.08 | INSTALACOES ELETRICAS / TELEFONICAS / ANTENAS / SPDA / DADOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08.01", "Descricao": "INSTALACAO ELETRICA", "Label": "OBR | 10060 CUSTO | 01.08.01 | INSTALACAO ELETRICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08.02", "Descricao": "INSTALACAO TELEFONICA", "Label": "OBR | 10060 CUSTO | 01.08.02 | INSTALACAO TELEFONICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08.03", "Descricao": "INSTALACAO DE DADOS ESTRUTURADOS", "Label": "OBR | 10060 CUSTO | 01.08.03 | INSTALACAO DE DADOS ESTRUTURADOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08.04", "Descricao": "ANTENA", "Label": "OBR | 10060 CUSTO | 01.08.04 | ANTENA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08.05", "Descricao": "INSTALACAO SPDA", "Label": "OBR | 10060 CUSTO | 01.08.05 | INSTALACAO SPDA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.08.06", "Descricao": "LUMINARIAS", "Label": "OBR | 10060 CUSTO | 01.08.06 | LUMINARIAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.09", "Descricao": "INSTALACOES HIDRAULICA / SANITARIA / GAS / INCENDIO", "Label": "OBR | 10060 CUSTO | 01.09 | INSTALACOES HIDRAULICA / SANITARIA / GAS / INCENDIO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.09.01", "Descricao": "INSTALACAO HIDRAULICA", "Label": "OBR | 10060 CUSTO | 01.09.01 | INSTALACAO HIDRAULICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.09.02", "Descricao": "INSTALACAO SANITARIA / PLUVIAL / DRENO", "Label": "OBR | 10060 CUSTO | 01.09.02 | INSTALACAO SANITARIA / PLUVIAL / DRENO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.09.03", "Descricao": "INSTALACAO GAS", "Label": "OBR | 10060 CUSTO | 01.09.03 | INSTALACAO GAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.09.04", "Descricao": "INSTALACAO INCENDIO", "Label": "OBR | 10060 CUSTO | 01.09.04 | INSTALACAO INCENDIO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.10", "Descricao": "INSTALACOES MECANICAS", "Label": "OBR | 10060 CUSTO | 01.10 | INSTALACOES MECANICAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.10.01", "Descricao": "EXAUSTAO MECANICA", "Label": "OBR | 10060 CUSTO | 01.10.01 | EXAUSTAO MECANICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.10.02", "Descricao": "PRESSURIZACAO MECANICA", "Label": "OBR | 10060 CUSTO | 01.10.02 | PRESSURIZACAO MECANICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.10.03", "Descricao": "REDE FRIGORIGENA", "Label": "OBR | 10060 CUSTO | 01.10.03 | REDE FRIGORIGENA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.10.04", "Descricao": "EQUIPAMENTOS DE AR CONDICIONADO", "Label": "OBR | 10060 CUSTO | 01.10.04 | EQUIPAMENTOS DE AR CONDICIONADO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.10.05", "Descricao": "ELEVADOR", "Label": "OBR | 10060 CUSTO | 01.10.05 | ELEVADOR"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.11", "Descricao": "LOUCAS / METAIS / BANCADAS / ACESSORIOS", "Label": "OBR | 10060 CUSTO | 01.11 | LOUCAS / METAIS / BANCADAS / ACESSORIOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.11.01", "Descricao": "LOUCAS", "Label": "OBR | 10060 CUSTO | 01.11.01 | LOUCAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.11.02", "Descricao": "METAIS", "Label": "OBR | 10060 CUSTO | 01.11.02 | METAIS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.11.03", "Descricao": "BANCADAS", "Label": "OBR | 10060 CUSTO | 01.11.03 | BANCADAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.11.04", "Descricao": "ACESSORIOS", "Label": "OBR | 10060 CUSTO | 01.11.04 | ACESSORIOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.12", "Descricao": "IMPERMEABILIZACOES / TRATAMENTO TERMICO / ACUSTICO", "Label": "OBR | 10060 CUSTO | 01.12 | IMPERMEABILIZACOES / TRATAMENTO TERMICO / ACUSTICO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.12.01", "Descricao": "IMPERMEABILIZACAO", "Label": "OBR | 10060 CUSTO | 01.12.01 | IMPERMEABILIZACAO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.12.02", "Descricao": "TRATAMENTO DE JUNTA DE DILATACAO", "Label": "OBR | 10060 CUSTO | 01.12.02 | TRATAMENTO DE JUNTA DE DILATACAO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.12.03", "Descricao": "TRATAMENTO / ISOLAMENTO ACUSTICO", "Label": "OBR | 10060 CUSTO | 01.12.03 | TRATAMENTO / ISOLAMENTO ACUSTICO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.12.04", "Descricao": "TRATAMENTO / ISOLAMENTO TERMICO", "Label": "OBR | 10060 CUSTO | 01.12.04 | TRATAMENTO / ISOLAMENTO TERMICO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.13", "Descricao": "REVESTIMENTOS DE PAREDES INTERNAS E ARREMATES", "Label": "OBR | 10060 CUSTO | 01.13 | REVESTIMENTOS DE PAREDES INTERNAS E ARREMATES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.13.01", "Descricao": "REVESTIMENTOS DE PAREDES INTERNAS E ARREMATES", "Label": "OBR | 10060 CUSTO | 01.13.01 | REVESTIMENTOS DE PAREDES INTERNAS E ARREMATES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.13.01", "Descricao": "REVESTIMENTOS DE PAREDES INTERNAS E ARREMATES - MO", "Label": "OBR | 10060 CUSTO | 01.13.01 | REVESTIMENTOS DE PAREDES INTERNAS E ARREMATES - MO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.14", "Descricao": "REVESTIMENTOS DE PAREDES EXTERNAS E ARREMATES", "Label": "OBR | 10060 CUSTO | 01.14 | REVESTIMENTOS DE PAREDES EXTERNAS E ARREMATES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.14.01", "Descricao": "REVESTIMENTOS DE PAREDES EXTERNAS E ARREMATES", "Label": "OBR | 10060 CUSTO | 01.14.01 | REVESTIMENTOS DE PAREDES EXTERNAS E ARREMATES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.15", "Descricao": "REVESTIMENTOS DE TETOS / FORROS", "Label": "OBR | 10060 CUSTO | 01.15 | REVESTIMENTOS DE TETOS / FORROS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.15.01", "Descricao": "REVESTIMENTO DE TETO", "Label": "OBR | 10060 CUSTO | 01.15.01 | REVESTIMENTO DE TETO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.15.02", "Descricao": "FORRO DE TETO", "Label": "OBR | 10060 CUSTO | 01.15.02 | FORRO DE TETO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.15.03", "Descricao": "FIRE STOP SHAFT / COMPARTIMENTACAO", "Label": "OBR | 10060 CUSTO | 01.15.03 | FIRE STOP SHAFT / COMPARTIMENTACAO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.16", "Descricao": "COBERTURAS", "Label": "OBR | 10060 CUSTO | 01.16 | COBERTURAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.16.01", "Descricao": "RUFOS / CALHAS", "Label": "OBR | 10060 CUSTO | 01.16.01 | RUFOS / CALHAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.16.02", "Descricao": "ESTRUTURA PARA COBERTURA / TELHAMENTO", "Label": "OBR | 10060 CUSTO | 01.16.02 | ESTRUTURA PARA COBERTURA / TELHAMENTO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17", "Descricao": "PAVIMENTACAO", "Label": "OBR | 10060 CUSTO | 01.17 | PAVIMENTACAO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.01", "Descricao": "REGULARIZACAO DE SUPERFICIE", "Label": "OBR | 10060 CUSTO | 01.17.01 | REGULARIZACAO DE SUPERFICIE"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.02", "Descricao": "SOLEIRAS E FILETES", "Label": "OBR | 10060 CUSTO | 01.17.02 | SOLEIRAS E FILETES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.03", "Descricao": "PAVIMENTACAO CERAMICA", "Label": "OBR | 10060 CUSTO | 01.17.03 | PAVIMENTACAO CERAMICA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.04", "Descricao": "PEDRA NATURAL", "Label": "OBR | 10060 CUSTO | 01.17.04 | PEDRA NATURAL"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.05", "Descricao": "PAVIMENTACAO CIMENTICIA", "Label": "OBR | 10060 CUSTO | 01.17.05 | PAVIMENTACAO CIMENTICIA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.06", "Descricao": "PAVIMENTACAO MADEIRA", "Label": "OBR | 10060 CUSTO | 01.17.06 | PAVIMENTACAO MADEIRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.07", "Descricao": "PAVIMENTACAO VINILICA / EMBORRACHADA", "Label": "OBR | 10060 CUSTO | 01.17.07 | PAVIMENTACAO VINILICA / EMBORRACHADA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.17.07", "Descricao": "PAVIMENTACAO VINILICA / EMBORRACHADA /ESPECIAIS", "Label": "OBR | 10060 CUSTO | 01.17.07 | PAVIMENTACAO VINILICA / EMBORRACHADA /ESPECIAIS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.18", "Descricao": "VIDROS", "Label": "OBR | 10060 CUSTO | 01.18 | VIDROS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.18.01", "Descricao": "VIDRO DE SEGURANCA", "Label": "OBR | 10060 CUSTO | 01.18.01 | VIDRO DE SEGURANCA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.18.02", "Descricao": "VIDRO TEMPERADO", "Label": "OBR | 10060 CUSTO | 01.18.02 | VIDRO TEMPERADO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.18.03", "Descricao": "VIDRO LAMINADO", "Label": "OBR | 10060 CUSTO | 01.18.03 | VIDRO LAMINADO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.18.04", "Descricao": "VIDRO COMUM", "Label": "OBR | 10060 CUSTO | 01.18.04 | VIDRO COMUM"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.18.05", "Descricao": "VIDRO ARAMADO", "Label": "OBR | 10060 CUSTO | 01.18.05 | VIDRO ARAMADO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19", "Descricao": "PINTURAS", "Label": "OBR | 10060 CUSTO | 01.19 | PINTURAS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.01", "Descricao": "PINTURA INTERNA", "Label": "OBR | 10060 CUSTO | 01.19.01 | PINTURA INTERNA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.02", "Descricao": "PINTURA EXTERNA", "Label": "OBR | 10060 CUSTO | 01.19.02 | PINTURA EXTERNA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.03", "Descricao": "PINTURA SOBRE ACO / TUBOS", "Label": "OBR | 10060 CUSTO | 01.19.03 | PINTURA SOBRE ACO / TUBOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.03", "Descricao": "PINTURA SOBRE ACO/TUBOS", "Label": "OBR | 10060 CUSTO | 01.19.03 | PINTURA SOBRE ACO/TUBOS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.04", "Descricao": "PINTURA SOBRE MADEIRA", "Label": "OBR | 10060 CUSTO | 01.19.04 | PINTURA SOBRE MADEIRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.05", "Descricao": "CAIACAO POCO DE ELEVADOR", "Label": "OBR | 10060 CUSTO | 01.19.05 | CAIACAO POCO DE ELEVADOR"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.19.06", "Descricao": "PINTURA SOBRE PISO", "Label": "OBR | 10060 CUSTO | 01.19.06 | PINTURA SOBRE PISO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.20", "Descricao": "PAISAGISMO", "Label": "OBR | 10060 CUSTO | 01.20 | PAISAGISMO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.20.01", "Descricao": "PAISAGISMO", "Label": "OBR | 10060 CUSTO | 01.20.01 | PAISAGISMO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.21", "Descricao": "SERVICOS COMPLEMENTARES", "Label": "OBR | 10060 CUSTO | 01.21 | SERVICOS COMPLEMENTARES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.21.01", "Descricao": "SERVICOS COMPLEMENTARES", "Label": "OBR | 10060 CUSTO | 01.21.01 | SERVICOS COMPLEMENTARES"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.21.02", "Descricao": "COMUNICACAO VISUAL", "Label": "OBR | 10060 CUSTO | 01.21.02 | COMUNICACAO VISUAL"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.22", "Descricao": "LIMPEZA DE OBRA / SERVICOS FINAIS", "Label": "OBR | 10060 CUSTO | 01.22 | LIMPEZA DE OBRA / SERVICOS FINAIS"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.22.01", "Descricao": "LIMPEZA PERMANENTE DE OBRA", "Label": "OBR | 10060 CUSTO | 01.22.01 | LIMPEZA PERMANENTE DE OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.22.02", "Descricao": "REMOCAO DE ENTULHO", "Label": "OBR | 10060 CUSTO | 01.22.02 | REMOCAO DE ENTULHO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.22.03", "Descricao": "LIMPEZA FINAL DE OBRA", "Label": "OBR | 10060 CUSTO | 01.22.03 | LIMPEZA FINAL DE OBRA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "01.22.04", "Descricao": "CONSULTORIAS PARA ENTREGA", "Label": "OBR | 10060 CUSTO | 01.22.04 | CONSULTORIAS PARA ENTREGA"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "02.01", "Descricao": "TAXA DE ADMINISTRACAO DE OBRA (CONSTRUTORA)", "Label": "OBR | 10060 CUSTO | 02.01 | TAXA DE ADMINISTRACAO DE OBRA (CONSTRUTORA)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "03.01", "Descricao": "CUSTO OBRA MASTERPLAN PARA A SPE", "Label": "OBR | 10060 CUSTO | 03.01 | CUSTO OBRA MASTERPLAN PARA A SPE"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "04.01", "Descricao": "AREA COMUM", "Label": "OBR | 10060 CUSTO | 04.01 | AREA COMUM"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "04.02", "Descricao": "APARTAMENTO", "Label": "OBR | 10060 CUSTO | 04.02 | APARTAMENTO"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "04.03", "Descricao": "TAXA DE ADMINISTRACAO DO FF&E", "Label": "OBR | 10060 CUSTO | 04.03 | TAXA DE ADMINISTRACAO DO FF&E"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "05.01", "Descricao": "OUTROS (MIGRACAO)", "Label": "OBR | 10060 CUSTO | 05.01 | OUTROS (MIGRACAO)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "2", "Descricao": "ADMINISTRACAO DE OBRA (CONSTRUTORA)", "Label": "OBR | 10060 CUSTO | 2 | ADMINISTRACAO DE OBRA (CONSTRUTORA)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "3", "Descricao": "CUSTO OBRA MASTERPLAN PARA A SPE", "Label": "OBR | 10060 CUSTO | 3 | CUSTO OBRA MASTERPLAN PARA A SPE"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "4", "Descricao": "MOBILIARIO DESIGN & EQUIPAMENTOS (FF&E)", "Label": "OBR | 10060 CUSTO | 4 | MOBILIARIO DESIGN & EQUIPAMENTOS (FF&E)"}, {"Obra": "OBR", "Produto": "10060 CUSTO", "Item": "5", "Descricao": "MIGRAÇÃO", "Label": "OBR | 10060 CUSTO | 5 | MIGRAÇÃO"}, {"Obra": "STV", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "STV | 10050 DEVOLUCAO/ESTORNO | 08.05 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "STV", "Produto": "10050 DEVOLUCAO/ESTORNO", "Item": "08.05.01", "Descricao": "DEVOLUCAO E ESTORNO (CONCILIACAO)", "Label": "STV | 10050 DEVOLUCAO/ESTORNO | 08.05.01 | DEVOLUCAO E ESTORNO (CONCILIACAO)"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19", "Descricao": "DESPESA ESTANDE DE VENDAS", "Label": "STV | 10070 DESPESA | 19 | DESPESA ESTANDE DE VENDAS"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.01", "Descricao": "CENTRAL DE VENDAS / UNIDADE MODELO", "Label": "STV | 10070 DESPESA | 19.01 | CENTRAL DE VENDAS / UNIDADE MODELO"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.01", "Descricao": "CONSTRUCAO ESTANDE DE VENDAS", "Label": "STV | 10070 DESPESA | 19.01 | CONSTRUCAO ESTANDE DE VENDAS"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.01", "Descricao": "ENXOVAL DO ESTANDE DE VENDAS", "Label": "STV | 10070 DESPESA | 19.01 | ENXOVAL DO ESTANDE DE VENDAS"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.01", "Descricao": "PDV EM CONTAINER", "Label": "STV | 10070 DESPESA | 19.01 | PDV EM CONTAINER"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.02", "Descricao": "CENTRAL DE VENDAS / UNIDADE MODELO (MANUTENCAO MENSAL)", "Label": "STV | 10070 DESPESA | 19.02 | CENTRAL DE VENDAS / UNIDADE MODELO (MANUTENCAO MENSAL)"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.02", "Descricao": "DESPESA MENSAL DE OPERACAO CENTRAL DE VENDAS", "Label": "STV | 10070 DESPESA | 19.02 | DESPESA MENSAL DE OPERACAO CENTRAL DE VENDAS"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.02", "Descricao": "MANUTENCAO ESTANDE DE VENDAS", "Label": "STV | 10070 DESPESA | 19.02 | MANUTENCAO ESTANDE DE VENDAS"}, {"Obra": "STV", "Produto": "10070 DESPESA", "Item": "19.02", "Descricao": "MANUTENCAO PDV EM CONTAINER", "Label": "STV | 10070 DESPESA | 19.02 | MANUTENCAO PDV EM CONTAINER"}];


let manualMappings=[], aiMappings=[], aiFileData=null, aiDescs=[], aiRowData=[], aiAccepted={}, aiAllResults={};
const OBRAS=[...new Set(EAP_DATA.map(e=>e.Obra))].sort();

// ====================== SYSTEM PROMPT ======================
const SYSTEM_PROMPT = `Voce e um especialista senior em contabilidade e gestao financeira de empreendimentos imobiliarios (SPE/incorporacao) no Brasil.

Sua tarefa: classificar lancamentos financeiros na categoria correta do Plano de Contas (EAP) fornecido.

REGRAS CRITICAS:

1. NOMES DE COLUNAS VARIAVEIS: Os lancamentos vem de planilhas de clientes diferentes. Nomes de colunas variam - "Fornecedor" pode ser "Origem", "Credor", "Razao Social", etc. "Descricao" pode ser "Historico", "Observacao", "Detalhamento". Voce DEVE identificar o que cada campo representa pelo nome E conteudo. Nunca dependa de nomes fixos de colunas.

2. PRIORIDADE DOS CAMPOS (em ordem de importancia):
   - Campo de DESCRICAO (o que foi comprado/pago - MAIS IMPORTANTE)
   - Campo de FORNECEDOR/ORIGEM (quem recebeu o pagamento - segundo mais importante)
   - VALOR e PARCELAS (contextualizam)
   - DATAS (raramente relevantes para classificacao)

3. REGRA DE LITERALIDADE: A descricao do lancamento e LITERAL. Se esta escrito "CONCRETO", e concreto. Se esta escrito "ENERGIA ELETRICA", e consumo de energia. NUNCA reinterprete ou adivinhe outro significado.

4. REGRA ANTI-ALUCINACAO: NUNCA invente informacoes que nao estao nos dados. Sua justificativa deve APENAS referenciar campos que realmente existem no lancamento. Use este template obrigatorio: "Campo [nome do campo] indica [X], campo [nome do campo] confirma contexto de [Y]".

5. FIDELIDADE AO PLANO DE CONTAS: Classifique SOMENTE usando categorias que EXISTEM no Plano de Contas fornecido. Copie a descricao EXATA - nunca parafraseie nem invente categorias.

6. ESCALA DE CONFIANCA (0-100):
   - 90-100: Correspondencia direta e obvia (descricao casa literalmente com categoria da EAP)
   - 70-89: Boa correspondencia com alguma ambiguidade
   - 50-69: Classificacao provavel mas incerta
   - Abaixo de 50: Praticamente um chute

7. ERROS COMUNS - NAO FACA:
   - NAO classifique "CONCRETO" como "CONSUMOS (AGUA, ENERGIA)" - concreto e material de construcao
   - NAO invente que um fornecedor "fornece agua potavel" quando isso NAO esta escrito
   - NAO ignore a descricao literal para criar narrativa alternativa
   - NAO associe "fundacoes" (fundacao estrutural de obra) com "agua/consumos"
   - NAO classifique materiais de construcao (cimento, ferro, areia, concreto) como utilities/consumos
   - NAO parafraseie nomes de categorias da EAP

8. EXEMPLOS CORRETOS:
   - Descricao "CONCRETO" + fornecedor "GEOTESC FUNDACOES" = OBR | FUNDACAO ou ESTRUTURA (custo de obra)
   - Descricao "ENERGIA ELETRICA" + "CEMIG" = CONSUMOS (AGUA, ENERGIA E INTERNET / TELEFONE)
   - Descricao "HONORARIOS" + "ESCRITORIO XYZ ADVOGADOS" = DESPESAS JURIDICAS ou CONSULTORIAS JURIDICAS
   - Descricao "AGUA" + empresa de saneamento = CONSUMOS (AGUA, ENERGIA E INTERNET / TELEFONE)
   - Descricao "CIMENTO 50 SACOS" = material de obra, CUSTO OBRA
   - Descricao "Contabilidade" = DESPESAS CONTABEIS`;

// ====================== INIT ======================
function init(){
  ['aiObraFilter','manObra','eapObraFilter'].forEach(id=>{
    const s=document.getElementById(id);
    OBRAS.forEach(o=>{const op=document.createElement('option');op.value=o;op.textContent=o;s.appendChild(op)});
  });
  updateManualOptions();renderEAPTable();
  document.getElementById('manData').valueAsDate=new Date();
}

function showTab(n){
  document.querySelectorAll('.tab').forEach((t,i)=>t.classList.toggle('active',i===n));
  document.querySelectorAll('.section').forEach((s,i)=>s.classList.toggle('active',i===n));
}
function escHTML(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}

function logMsg(msg){
  const log=document.getElementById('aiLog');
  log.classList.remove('hidden');
  const ts=new Date().toLocaleTimeString();
  log.innerHTML+='<div>['+ts+'] '+escHTML(msg)+'</div>';
  log.scrollTop=log.scrollHeight;
}

// ====================== API HELPERS ======================
function getAPIKey(){
  const k=document.getElementById('apiKey').value.trim();
  if(!k){alert('Insira a API Key da Anthropic.');return null;}
  return k;
}

function getHeaders(apiKey){
  return {
    'Content-Type':'application/json',
    'x-api-key':apiKey,
    'anthropic-version':'2023-06-01',
    'anthropic-dangerous-direct-browser-access':'true'
  };
}

function buildEAPContext(obraFilter){
  let data=EAP_DATA;
  if(obraFilter&&obraFilter!=='TODAS')data=data.filter(e=>e.Obra===obraFilter);
  let ctx='PLANO DE CONTAS (EAP) - Categorias disponiveis:\nFormato: Obra | Produto | Item | Descricao\n'+'-'.repeat(60)+'\n';
  data.forEach(e=>{ctx+=e.Obra+' | '+e.Produto+' | '+e.Item+' | '+e.Descricao+'\n'});
  return ctx;
}

function rowToText(row){
  return Object.entries(row).map(([k,v])=>k+': '+String(v??'')).join(' | ');
}

function rowToFields(row){
  return Object.entries(row).map(([k,v])=>k+': '+String(v??'')).join('\n');
}

// ====================== STAGE 1: DIRECT CLASSIFICATION ======================
async function callClaudeStage1(rows, descs, obraFilter){
  const apiKey=getAPIKey();
  if(!apiKey)return null;

  const eapContext=buildEAPContext(obraFilter);
  const BATCH=15;
  const allResults={};
  const batches=[];
  for(let i=0;i<rows.length;i+=BATCH){
    batches.push({rows:rows.slice(i,i+BATCH),descs:descs.slice(i,i+BATCH),startIdx:i});
  }

  for(let b=0;b<batches.length;b++){
    const batch=batches[b];
    const pct=Math.round(((b+1)/batches.length)*100);
    document.getElementById('aiProgressText').textContent='Etapa 1: Lote '+(b+1)+'/'+batches.length+' ('+batch.rows.length+' itens)...';
    document.getElementById('aiProgressBar').style.width=(pct*0.7)+'%';

    let itemsText='';
    batch.rows.forEach((row,i)=>{
      itemsText+='\n--- LANCAMENTO '+(i+1)+' ---\n';
      itemsText+=rowToFields(row)+'\n';
    });

    const userPrompt=`${eapContext}

---

Classifique os seguintes lancamentos financeiros. Cada lancamento inclui TODOS os campos da planilha original com seus nomes originais de coluna. Identifique quais campos sao descricao, fornecedor, valor, etc. pelo nome e conteudo.

${itemsText}

---

Responda APENAS com JSON puro (sem markdown, sem crases). Para cada lancamento, o campo "numero" DEVE corresponder ao numero do lancamento acima. A justificativa DEVE seguir o template: "Campo [nome do campo] indica [X], campo [nome do campo] confirma contexto de [Y]".

{"mapeamentos":[{"numero":1,"sugestoes":[{"obra":"SIGLA","produto":"codigo","item":"codigo","descricao_eap":"DESCRICAO EXATA DO PLANO DE CONTAS","confianca":85,"justificativa":"Campo [X] indica [Y], campo [Z] confirma contexto de [W]"}],"etapa":1}]}`;

    let success=false;
    for(let attempt=0;attempt<3&&!success;attempt++){
      if(attempt>0){
        logMsg('Lote '+(b+1)+': tentativa '+(attempt+1)+'/3...');
        await new Promise(r=>setTimeout(r,2000*attempt));
      }
      try{
        const resp=await fetch('https://api.anthropic.com/v1/messages',{
          method:'POST',
          headers:getHeaders(apiKey),
          body:JSON.stringify({
            model:'claude-sonnet-4-5-20250929',
            max_tokens:8192,
            system:SYSTEM_PROMPT,
            messages:[{role:'user',content:userPrompt}]
          })
        });
        if(!resp.ok){
          if(resp.status===429&&attempt<2){logMsg('Rate limited, aguardando...');continue;}
          const err=await resp.text();
          throw new Error('API erro '+resp.status+': '+err);
        }
        const result=await resp.json();
        const text=result.content.filter(c=>c.type==='text').map(c=>c.text).join('');
        let parsed;
        try{parsed=JSON.parse(text)}catch(e){
          const m=text.match(/\{[\s\S]*\}/);
          if(m)parsed=JSON.parse(m[0]);else throw new Error('JSON invalido na resposta');
        }
        const mappings=parsed.mapeamentos||[];
        // Match by number
        mappings.forEach((item,i)=>{
          const sugs=(item.sugestoes||[]).filter(s=>s&&s.obra).map(s=>({
            Obra:s.obra,Produto:s.produto||'',Item:s.item,
            Descricao:s.descricao_eap,Score:s.confianca||50,
            Justificativa:s.justificativa||'',Etapa:1,FonteWeb:''
          }));
          if(!sugs.length)return;
          const num=parseInt(item.numero);
          if(num>=1&&num<=batch.descs.length){
            allResults[batch.descs[num-1]]=sugs;
          }
        });
        // Positional fallback
        if(mappings.length===batch.descs.length){
          mappings.forEach((item,i)=>{
            if(!allResults[batch.descs[i]]){
              const sugs=(item.sugestoes||[]).filter(s=>s&&s.obra).map(s=>({
                Obra:s.obra,Produto:s.produto||'',Item:s.item,
                Descricao:s.descricao_eap,Score:s.confianca||50,
                Justificativa:s.justificativa||'',Etapa:1,FonteWeb:''
              }));
              if(sugs.length)allResults[batch.descs[i]]=sugs;
            }
          });
        }
        success=true;
        logMsg('Lote '+(b+1)+' concluido: '+mappings.length+' classificacoes');
      }catch(e){
        console.error(e);
        logMsg('Erro lote '+(b+1)+': '+e.message);
      }
    }
  }
  return allResults;
}

// ====================== STAGE 2: WEB SEARCH ======================
async function callClaudeStage2(row, desc, eapContext, stage1Sug){
  const apiKey=getAPIKey();
  if(!apiKey)return null;

  const rowText=rowToFields(row);
  const stage1Info=stage1Sug?('Classificacao anterior (confianca '+stage1Sug.Score+'%): '+stage1Sug.Obra+' | '+stage1Sug.Item+' | '+stage1Sug.Descricao):'Nenhuma classificacao anterior.';

  const userPrompt=`Preciso reclassificar um lancamento financeiro com mais contexto.

LANCAMENTO:
${rowText}

CLASSIFICACAO ANTERIOR (baixa confianca):
${stage1Info}

${eapContext}

---

INSTRUCOES:
1. Identifique qual campo representa o fornecedor/origem (pode ser "Origem", "Fornecedor", "Credor", "Razao Social" ou similar)
2. Pesquise esse fornecedor na internet para descobrir o ramo de atuacao da empresa
3. Com base no ramo de atuacao encontrado e na descricao do lancamento, reclassifique o lancamento
4. A justificativa DEVE seguir o template: "Campo [nome] indica [X], campo [nome] confirma [Y]. Pesquisa web: [resumo do encontrado]"

Responda APENAS com JSON puro:
{"obra":"SIGLA","produto":"codigo","item":"codigo","descricao_eap":"DESCRICAO EXATA","confianca":85,"justificativa":"...","fonte_web":"breve resumo do que foi encontrado sobre o fornecedor","etapa":2}`;

  try{
    const resp=await fetch('https://api.anthropic.com/v1/messages',{
      method:'POST',
      headers:getHeaders(apiKey),
      body:JSON.stringify({
        model:'claude-sonnet-4-5-20250929',
        max_tokens:4096,
        system:SYSTEM_PROMPT,
        tools:[{type:'web_search_20250305',name:'web_search',max_uses:3}],
        messages:[{role:'user',content:userPrompt}]
      })
    });
    if(!resp.ok){
      const err=await resp.text();
      throw new Error('API Stage2 erro '+resp.status+': '+err);
    }
    const result=await resp.json();
    const textParts=result.content.filter(c=>c.type==='text').map(c=>c.text);
    const text=textParts.join('');
    let parsed;
    try{parsed=JSON.parse(text)}catch(e){
      const m=text.match(/\{[\s\S]*\}/);
      if(m)parsed=JSON.parse(m[0]);else throw new Error('JSON invalido Stage2');
    }
    if(!parsed.obra)return null;
    return {
      Obra:parsed.obra,Produto:parsed.produto||'',Item:parsed.item,
      Descricao:parsed.descricao_eap,Score:parsed.confianca||60,
      Justificativa:parsed.justificativa||'',Etapa:2,
      FonteWeb:parsed.fonte_web||''
    };
  }catch(e){
    console.error(e);
    logMsg('Erro Etapa 2: '+e.message);
    return null;
  }
}

// ====================== FILE HANDLING ======================
function setAISource(type){
  document.getElementById('aiTextArea').classList.toggle('hidden',type!=='text');
  document.getElementById('aiFileArea').classList.toggle('hidden',type!=='file');
  document.getElementById('btnSrcText').classList.toggle('secondary',type!=='text');
  document.getElementById('btnSrcFile').classList.toggle('secondary',type!=='file');
}

function handleAIFile(input){
  const file=input.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=function(e){
    const wb=XLSX.read(e.target.result,{type:'array'});
    const ws=wb.Sheets[wb.SheetNames[0]];
    aiFileData=XLSX.utils.sheet_to_json(ws);
    if(!aiFileData.length)return;
    const cols=Object.keys(aiFileData[0]);
    const sel=document.getElementById('aiColPrimary');
    sel.innerHTML='';
    cols.forEach(c=>{const op=document.createElement('option');op.value=c;op.textContent=c;sel.appendChild(op)});
    document.getElementById('aiFilePreview').classList.remove('hidden');
    document.getElementById('aiFileInfo').textContent=aiFileData.length+' linhas carregadas, '+cols.length+' colunas detectadas. Todas serao enviadas para a IA.';
    updateAIDescs();
  };
  reader.readAsArrayBuffer(file);
}

function updateAIDescs(){
  if(!aiFileData)return;
  const primaryCol=document.getElementById('aiColPrimary').value;
  aiDescs=[];
  aiRowData=[];
  aiFileData.forEach(row=>{
    const primary=String(row[primaryCol]||'').trim();
    if(!primary)return;
    aiDescs.push(primary);
    aiRowData.push(row);
  });
  document.getElementById('aiFileInfo').textContent=aiDescs.length+' lancamentos prontos para analise ('+Object.keys(aiFileData[0]).length+' colunas cada).';
}

// ====================== MAIN ANALYSIS ======================
async function runAnalysis(){
  const obra=document.getElementById('aiObraFilter').value;

  let descs=[];
  let rows=[];
  if(!document.getElementById('aiTextArea').classList.contains('hidden')){
    descs=document.getElementById('aiText').value.split('\n').map(l=>l.trim()).filter(l=>l);
    rows=descs.map(d=>({Descricao:d}));
  }else{
    descs=aiDescs;
    rows=aiRowData;
  }
  if(!descs.length){alert('Insira pelo menos um lancamento.');return}

  const apiKey=getAPIKey();
  if(!apiKey)return;

  document.getElementById('btnAnalyze').disabled=true;
  document.getElementById('aiProgress').classList.remove('hidden');
  document.getElementById('aiLog').innerHTML='';
  document.getElementById('aiLog').classList.remove('hidden');
  document.getElementById('aiProgressBar').style.width='0%';
  document.getElementById('aiProgressText').textContent='Etapa 1: Classificando '+descs.length+' lancamentos...';

  aiAccepted={};
  aiAllResults={};

  logMsg('Iniciando Etapa 1: classificacao direta de '+descs.length+' lancamentos');

  // STAGE 1: Batch classification
  const stage1Results=await callClaudeStage1(rows,descs,obra);
  if(!stage1Results){
    document.getElementById('btnAnalyze').disabled=false;
    document.getElementById('aiProgress').classList.add('hidden');
    return;
  }

  // Copy stage 1 results
  Object.keys(stage1Results).forEach(k=>{aiAllResults[k]=stage1Results[k]});

  // Identify low confidence entries for Stage 2
  const lowConfidence=[];
  descs.forEach((desc,i)=>{
    const sugs=aiAllResults[desc];
    if(!sugs||sugs.length===0||sugs[0].Score<80){
      lowConfidence.push({desc,row:rows[i],idx:i,stage1:sugs?sugs[0]:null});
    }
  });

  logMsg('Etapa 1 concluida. '+Object.keys(aiAllResults).length+'/'+descs.length+' classificados. '+lowConfidence.length+' com confianca < 80% irao para Etapa 2.');

  // STAGE 2: Web search for low confidence
  if(lowConfidence.length>0){
    document.getElementById('aiProgressText').textContent='Etapa 2: Pesquisando '+lowConfidence.length+' fornecedores na web...';
    const eapContext=buildEAPContext(obra);

    for(let i=0;i<lowConfidence.length;i++){
      const entry=lowConfidence[i];
      const pct=70+Math.round(((i+1)/lowConfidence.length)*30);
      document.getElementById('aiProgressBar').style.width=pct+'%';
      document.getElementById('aiProgressText').textContent='Etapa 2: '+( i+1)+'/'+lowConfidence.length+' - pesquisando...';

      const rowSummary=rowToText(entry.row).substring(0,80);
      logMsg('Etapa 2 ['+( i+1)+'/'+lowConfidence.length+']: '+rowSummary+'...');

      const stage2Result=await callClaudeStage2(entry.row,entry.desc,eapContext,entry.stage1);
      if(stage2Result){
        aiAllResults[entry.desc]=[stage2Result];
        logMsg('  -> Reclassificado: '+stage2Result.Obra+' | '+stage2Result.Descricao+' ('+stage2Result.Score+'%) via web search');
        if(stage2Result.FonteWeb)logMsg('  -> Fonte web: '+stage2Result.FonteWeb);
      }else{
        logMsg('  -> Etapa 2 falhou, mantendo resultado da Etapa 1');
      }

      // Small delay between stage 2 calls
      if(i<lowConfidence.length-1)await new Promise(r=>setTimeout(r,500));
    }
  }

  // Ensure all entries have at least an empty array
  descs.forEach(d=>{if(!aiAllResults[d])aiAllResults[d]=[]});

  document.getElementById('aiProgressBar').style.width='100%';
  document.getElementById('aiProgressText').textContent='Concluido!';

  const etapa1Count=descs.filter(d=>aiAllResults[d]&&aiAllResults[d].length>0&&aiAllResults[d][0].Etapa===1).length;
  const etapa2Count=descs.filter(d=>aiAllResults[d]&&aiAllResults[d].length>0&&aiAllResults[d][0].Etapa===2).length;
  logMsg('Finalizado: '+etapa1Count+' via Etapa 1, '+etapa2Count+' via Etapa 2 (web search)');

  renderAIResults(descs,aiAllResults,obra);
  document.getElementById('btnAnalyze').disabled=false;
}

// ====================== RENDER RESULTS ======================
function renderAIResults(descs,results,obra){
  const container=document.getElementById('aiResultsList');
  container.innerHTML='';
  let mappedCount=0,etapa1=0,etapa2=0,totalCount=descs.length;

  descs.forEach((desc,idx)=>{
    const suggestions=results[desc]||[];
    const row=aiRowData.length>idx?aiRowData[idx]:null;
    const ctx=row?rowToText(row):'';
    let h='<div style="background:var(--trinus-card);border:1px solid var(--trinus-border);border-radius:12px;padding:18px;margin-bottom:14px">';
    h+='<div style="font-weight:600;font-size:15px;margin-bottom:4px;color:var(--trinus-text)">'+escHTML(desc)+'</div>';
    if(ctx&&ctx!==desc)h+='<div style="font-size:11px;color:var(--trinus-text-muted);margin-bottom:8px;word-break:break-all">'+escHTML(ctx)+'</div>';
    if(suggestions.length>0){
      mappedCount++;
      if(suggestions[0].Etapa===2)etapa2++;else etapa1++;
      suggestions.forEach((s,si)=>{
        const pct=Math.round(s.Score||0);
        const color=pct>=80?'#4ade80':pct>=60?'#fb923c':'#60a5fa';
        const etapaBadge=s.Etapa===2?'<span class="badge badge-2">Etapa 2</span> ':'<span class="badge badge-1">Etapa 1</span> ';
        h+='<div class="suggestion'+(si===0?' selected':'')+'" onclick="selectSug('+idx+','+si+',this)" data-idx="'+idx+'" data-si="'+si+'">';
        h+='<div style="display:flex;justify-content:space-between;align-items:center">';
        h+='<span>'+etapaBadge+'<strong>'+escHTML(s.Obra||'')+'</strong> | '+escHTML(s.Item||'')+' | '+escHTML(s.Descricao||'')+'</span>';
        h+='<span style="color:'+color+';font-weight:600">'+pct+'%</span>';
        h+='</div>';
        if(s.Justificativa)h+='<div style="font-size:12px;color:var(--trinus-text-muted);margin-top:4px">'+escHTML(s.Justificativa)+'</div>';
        if(s.FonteWeb)h+='<div style="font-size:11px;color:var(--trinus-cyan);margin-top:3px">Web: '+escHTML(s.FonteWeb)+'</div>';
        h+='<div class="score-bar"><div class="score-fill" style="width:'+pct+'%;background:'+color+'"></div></div>';
        h+='</div>';
      });
      aiAccepted[idx]={desc:desc,item:suggestions[0]};
    }else{
      h+='<div class="alert alert-warn">Nenhuma sugestao encontrada</div>';
    }
    h+='</div>';
    container.innerHTML+=h;
  });

  document.getElementById('aiMetrics').innerHTML=
    '<div class="metric"><div class="num">'+totalCount+'</div><div class="lbl">Total</div></div>'+
    '<div class="metric"><div class="num" style="-webkit-text-fill-color:#4ade80">'+mappedCount+'</div><div class="lbl">Classificados</div></div>'+
    '<div class="metric"><div class="num" style="-webkit-text-fill-color:var(--trinus-blue)">'+etapa1+'</div><div class="lbl">Etapa 1</div></div>'+
    '<div class="metric"><div class="num" style="-webkit-text-fill-color:var(--trinus-cyan)">'+etapa2+'</div><div class="lbl">Etapa 2 (web)</div></div>'+
    '<div class="metric"><div class="num" style="-webkit-text-fill-color:#fb923c">'+(totalCount-mappedCount)+'</div><div class="lbl">Sem sugestao</div></div>'+
    '<div class="metric"><div class="num">'+Math.round(mappedCount/totalCount*100)+'%</div><div class="lbl">Taxa</div></div>';

  document.getElementById('aiResults').classList.remove('hidden');
}

function selectSug(idx,si,el){
  const parent=el.closest('div[style*="background:var(--trinus-card)"]');
  parent.querySelectorAll('.suggestion').forEach(s=>s.classList.remove('selected'));
  el.classList.add('selected');
  const desc=aiAccepted[idx]?aiAccepted[idx].desc:'';
  const sugs=aiAllResults[desc]||[];
  if(sugs[si]){
    aiAccepted[idx]={desc:desc,item:sugs[si]};
  }
}

function confirmAIMappings(){
  aiMappings=[];
  Object.values(aiAccepted).forEach(a=>{
    if(a.item){
      const mapping={};
      // Include all original row data first
      if(aiFileData){
        const primaryCol=document.getElementById('aiColPrimary').value;
        const origRow=aiFileData.find(r=>String(r[primaryCol]||'').trim()===a.desc);
        if(origRow){
          Object.keys(origRow).forEach(col=>{mapping['Orig_'+col]=origRow[col]});
        }
      }
      mapping.EAP_Obra=a.item.Obra||'';
      mapping.EAP_Produto=a.item.Produto||'';
      mapping.EAP_Item=a.item.Item||'';
      mapping.EAP_Descricao=a.item.Descricao||'';
      mapping.Confianca=a.item.Score||'';
      mapping.Justificativa=a.item.Justificativa||'';
      mapping.Etapa=a.item.Etapa||1;
      mapping.Fonte_Web=a.item.FonteWeb||'';
      aiMappings.push(mapping);
    }
  });
  if(aiMappings.length===0){alert('Nenhum mapeamento para confirmar.');return}
  alert('Mapeamentos confirmados: '+aiMappings.length+' itens.\nClique em "Exportar para Excel" para baixar.');
}

// ====================== MANUAL ======================
function updateManualOptions(){
  const obra=document.getElementById('manObra').value;
  const sel=document.getElementById('manItem');sel.innerHTML='';
  let data=EAP_DATA;
  if(obra!=='TODAS')data=data.filter(e=>e.Obra===obra);
  data.forEach(e=>{const op=document.createElement('option');op.value=e.Label;op.textContent=e.Label;sel.appendChild(op)});
  sel.onchange=updateManualPreview;updateManualPreview();
}
function updateManualPreview(){
  const label=document.getElementById('manItem').value;
  const item=EAP_DATA.find(e=>e.Label===label);
  const div=document.getElementById('manPreview');
  if(item)div.innerHTML='<strong>Obra:</strong> '+item.Obra+'<br><strong>Produto:</strong> '+item.Produto+'<br><strong>Item:</strong> '+item.Item+'<br><strong>Descricao:</strong> '+item.Descricao;
}
function saveManualMapping(){
  const desc=document.getElementById('manDesc').value;if(!desc){alert('Preencha a descricao.');return}
  const label=document.getElementById('manItem').value;const item=EAP_DATA.find(e=>e.Label===label);
  const m={Descricao_Original:desc,Valor:parseFloat(document.getElementById('manValor').value)||0,
    Tipo:document.getElementById('manTipo').value,Data:document.getElementById('manData').value,
    Fornecedor:document.getElementById('manForn').value,
    EAP_Obra:item?item.Obra:'',EAP_Item:item?item.Item:'',EAP_Descricao:item?item.Descricao:''};
  manualMappings.push(m);
  const tbody=document.querySelector('#manTable tbody');const tr=document.createElement('tr');
  tr.innerHTML='<td>'+escHTML(m.Descricao_Original)+'</td><td>R$ '+m.Valor.toFixed(2)+'</td><td>'+m.Tipo+'</td><td>'+m.Data+'</td><td>'+escHTML(m.Fornecedor)+'</td><td>'+m.EAP_Obra+'</td><td>'+m.EAP_Item+'</td><td>'+escHTML(m.EAP_Descricao)+'</td>';
  tbody.appendChild(tr);
  document.getElementById('manResults').classList.remove('hidden');
  document.getElementById('manDesc').value='';document.getElementById('manForn').value='';
}

// ====================== EAP TABLE ======================
function renderEAPTable(){
  const obra=document.getElementById('eapObraFilter').value;
  const search=document.getElementById('eapSearch').value.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');
  let data=EAP_DATA;
  if(obra!=='TODAS')data=data.filter(e=>e.Obra===obra);
  if(search)data=data.filter(e=>e.Label.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').includes(search));
  const tbody=document.querySelector('#eapTable tbody');tbody.innerHTML='';
  data.forEach(e=>{const tr=document.createElement('tr');
    tr.innerHTML='<td>'+e.Obra+'</td><td>'+escHTML(e.Produto)+'</td><td>'+e.Item+'</td><td>'+escHTML(e.Descricao)+'</td>';
    tbody.appendChild(tr)});
  document.getElementById('eapMetrics').innerHTML=
    '<div class="metric"><div class="num">'+data.length+'</div><div class="lbl">Registros</div></div>'+
    '<div class="metric"><div class="num">'+new Set(data.map(e=>e.Obra)).size+'</div><div class="lbl">Obras</div></div>'+
    '<div class="metric"><div class="num">'+new Set(data.map(e=>e.Produto)).size+'</div><div class="lbl">Produtos</div></div>';
}

// ====================== EXPORT ======================
function toSheet(data){const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'DE-PARA');return wb}
function exportEAP(){XLSX.writeFile(toSheet(EAP_DATA),'eap_completa.xlsx')}
function exportManual(){if(!manualMappings.length){alert('Nenhum mapeamento manual.');return}XLSX.writeFile(toSheet(manualMappings),'de_para_manual.xlsx')}
function exportAIResults(){if(!aiMappings.length){alert('Confirme os mapeamentos primeiro.');return}XLSX.writeFile(toSheet(aiMappings),'de_para_ia.xlsx')}
function exportAll(){const all=[...manualMappings,...aiMappings];if(!all.length){alert('Nenhum mapeamento.');return}XLSX.writeFile(toSheet(all),'de_para_completo.xlsx')}

init();

</script>
<div style="margin-top:40px;padding:20px 32px;border-top:1px solid var(--trinus-border);text-align:center;color:var(--trinus-text-muted);font-size:12px">
Trinus Co. - Plataforma de Desenvolvimento Imobiliario | DE-PARA Mapeamento EAP v2.0
</div>
</body>
</html>
